<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0">
    <title>Kevin Roper</title>
    <link href="styles.css" rel="stylesheet">
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDOKvvM9afHhJIqkkH_sayrczcWq83cg4w&libraries=places&callback=initMap" async defer></script>
</head>
<body>
    <!-- Your map container -->
    <div id="map"></div>
    <div id="places-container">
        <h2>Nearby Places</h2>
        <ul id="places-list"></ul>
    </div>
    <script>
        let map;
        let infoWindow;
        let service;
        let placesList = document.getElementById("places-list");

        // Initialize the map
        function initMap() {
            map = new google.maps.Map(document.getElementById("map"), {
                center: { lat: 39.113014, lng: -105.358887 }, // Set initial map center
                zoom: 15, // Set initial zoom level
            });

            infoWindow = new google.maps.InfoWindow();

            // Initialize the Places service
            service = new google.maps.places.PlacesService(map);

            // Search for nearby restaurants
            searchNearby("restaurant");
        }

        // Search for nearby places and display them on the map
        function searchNearby(keyword) {
            const request = {
                location: map.getCenter(),
                radius: 1000, // Search radius in meters (adjust as needed)
                keyword: keyword,
            };

            service.nearbySearch(request, (results, status) => {
                if (status === google.maps.places.PlacesServiceStatus.OK) {
                    clearPlacesList();

                    for (const place of results) {
                        createMarker(place);
                        addPlaceToList(place);
                    }
                }
            });
        }

        // Create a marker for a place and add a click event listener
        function createMarker(place) {
            const marker = new google.maps.Marker({
                map: map,
                position: place.geometry.location,
                title: place.name,
            });

            marker.addListener("click", () => {
                showPlaceDetails(place, marker);
            });
        }

        // Show details of a selected place in the info window
        function showPlaceDetails(place, marker) {
            const detailsRequest = {
                placeId: place.place_id,
            };

            service.getDetails(detailsRequest, (details, status) => {
                if (status === google.maps.places.PlacesServiceStatus.OK) {
                    infoWindow.setContent(`<h3>${details.name}</h3><p>${details.formatted_address}</p>`);
                    infoWindow.open(map, marker);
                }
            });
        }

        // Add a place to the list of nearby places
        function addPlaceToList(place) {
            const li = document.createElement("li");
            li.textContent = place.name;
            placesList.appendChild(li);
        }

        // Clear the list of nearby places
        function clearPlacesList() {
            placesList.innerHTML = "";
        }
    </script>
</body>
</html>
